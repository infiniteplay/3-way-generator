<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PO, Invoice & GRN Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f7fa;
            color: #2d3748;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .header {
            background: white;
            text-align: center;
            padding: 40px 20px;
            border-bottom: 1px solid #e2e8f0;
        }

        .header h1 {
            font-size: 2.2rem;
            color: #1a202c;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .header p {
            color: #718096;
            font-size: 1rem;
        }

        .form-section {
            padding: 40px;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-bottom: 32px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 500;
            color: #374151;
            margin-bottom: 6px;
            font-size: 14px;
        }

        .form-group input, .form-group select, .form-group textarea {
            padding: 12px 16px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.2s ease;
            background: white;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .items-section {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            margin: 24px 0;
        }

        .items-header {
            background: #374151;
            color: white;
            padding: 16px 20px;
            font-weight: 500;
            border-radius: 8px 8px 0 0;
        }

        .items-content {
            padding: 20px;
        }

        .item-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr auto;
            gap: 12px;
            align-items: center;
            margin-bottom: 12px;
            padding: 16px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e5e7eb;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
            padding: 8px 12px;
            font-size: 12px;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-outline {
            background: white;
            color: #374151;
            border: 1px solid #d1d5db;
        }

        .btn-outline:hover {
            background: #f9fafb;
        }

        .documents {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 24px;
            padding: 40px;
            background: #f9fafb;
        }

        .document {
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            overflow: hidden;
        }

        .document-header {
            padding: 20px;
            color: white;
            font-weight: 500;
            font-size: 1.1rem;
            text-align: center;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .po-header { background: #3b82f6; }
        .invoice-header { background: #ef4444; }
        .grn-header { background: #10b981; }

        .document-content {
            padding: 24px;
            font-size: 13px;
            line-height: 1.5;
        }

        .doc-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            padding: 4px 0;
        }

        .doc-row:last-child {
            border-top: 2px solid #e5e7eb;
            font-weight: 600;
            background: #f9fafb;
            padding: 12px;
            border-radius: 4px;
            margin-top: 16px;
        }

        .doc-label {
            font-weight: 500;
            color: #374151;
        }

        .table-header {
            background: #374151;
            color: white;
            padding: 12px;
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 8px;
            font-weight: 500;
            text-align: center;
            font-size: 12px;
        }

        .table-row {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 8px;
            padding: 10px 12px;
            border-bottom: 1px solid #e5e7eb;
            text-align: center;
            font-size: 12px;
        }

        .table-row:nth-child(even) {
            background: #f9fafb;
        }

        .hidden {
            display: none;
        }

        .actions {
            text-align: center;
            padding: 32px 40px;
            background: white;
        }

        .download-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 14px;
            padding: 4px;
            border-radius: 4px;
            transition: background 0.2s ease;
        }

        .download-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .item-row {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .documents {
                grid-template-columns: 1fr;
                padding: 20px;
            }
            
            .table-header, .table-row {
                grid-template-columns: 1fr;
                text-align: left;
            }

            .form-section {
                padding: 20px;
            }

            .document-header {
                flex-direction: column;
                gap: 8px;
            }
        }

        /* Print styles for PDF */
        @media print {
            body { background: white; }
            .container { box-shadow: none; }
            .document { break-inside: avoid; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <!-- Replace the src URL below with your logo URL -->
            <img src="https://via.placeholder.com/200x80/3b82f6/ffffff?text=Your+Logo" alt="Company Logo" style="max-height: 80px; margin-bottom: 20px; border-radius: 8px;">
            
            <h1>PO, Invoice and GRN Generator</h1>
            <p>Create Purchase Orders, Invoices & GRN with PDF download</p>
        </div>

        <div class="form-section">
            <div class="form-grid">
                <div class="form-group">
                    <label>Customer Name</label>
                    <select id="customerSelect">
                        <option value="">Select Customer</option>
                        <option value="hindustan">Hindustan Unilever Limited</option>
                        <option value="itc">ITC Limited</option>
                        <option value="nestle">Nestlé India Limited</option>
                        <option value="britannia">Britannia Industries Limited</option>
                        <option value="dabur">Dabur India Limited</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>PO Number</label>
                    <input type="text" id="poNumber" placeholder="Enter PO Number">
                </div>

                <div class="form-group">
                    <label>Vendor Name</label>
                    <input type="text" id="vendorName" value="Growquest Consulting LLP" readonly>
                </div>

                <div class="form-group">
                    <label>Vendor Address</label>
                    <textarea id="vendorAddress" readonly>404, Lakedew, Haralur, Bangalore 560102</textarea>
                </div>

                <div class="form-group">
                    <label>Vendor GST Number</label>
                    <input type="text" id="vendorGst" value="29AABCB1043Q1ZI" readonly>
                </div>
            </div>

            <div class="items-section">
                <div class="items-header">
                    Items
                </div>
                <div class="items-content" id="itemsContainer">
                    <!-- Items will be added here dynamically -->
                </div>
                <div style="padding: 0 20px 20px;">
                    <button class="btn btn-success" onclick="addItem()">Add Item</button>
                </div>
            </div>

            <div class="actions">
                <button class="btn btn-primary" onclick="generateDocuments()">Generate All Documents</button>
            </div>
        </div>

        <div id="documentsSection" class="documents hidden">
            <div class="document">
                <div class="document-header po-header">
                    <span>Purchase Order</span>
                    <button class="download-btn" onclick="downloadPDF('po')">⬇ PDF</button>
                </div>
                <div class="document-content" id="poContent">
                    <!-- PO content will be generated here -->
                </div>
            </div>

            <div class="document">
                <div class="document-header invoice-header">
                    <span>Invoice</span>
                    <button class="download-btn" onclick="downloadPDF('invoice')">⬇ PDF</button>
                </div>
                <div class="document-content" id="invoiceContent">
                    <!-- Invoice content will be generated here -->
                </div>
            </div>

            <div class="document">
                <div class="document-header grn-header">
                    <span>Goods Receipt Note</span>
                    <button class="download-btn" onclick="downloadPDF('grn')">⬇ PDF</button>
                </div>
                <div class="document-content" id="grnContent">
                    <!-- GRN content will be generated here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // FMCG Customer data
        const customers = {
            hindustan: {
                name: "Hindustan Unilever Limited",
                address: "Unilever House, B.D. Sawant Marg, Chakala, Andheri (East), Mumbai - 400099, Maharashtra",
                gst: "27AAACH6066F1ZW"
            },
            itc: {
                name: "ITC Limited",
                address: "Virginia House, 37 J.L. Nehru Road, Kolkata - 700071, West Bengal",
                gst: "19AAACI1681G1Z5"
            },
            nestle: {
                name: "Nestlé India Limited",
                address: "Nestlé House, Jacaranda Marg, 'M' Block, DLF City Phase II, Gurgaon - 122002, Haryana",
                gst: "06AAACN4012P1ZH"
            },
            britannia: {
                name: "Britannia Industries Limited",
                address: "Britannia House, 1-A Hungerford Street, Kolkata - 700017, West Bengal",
                gst: "19AAACB5324L1ZY"
            },
            dabur: {
                name: "Dabur India Limited",
                address: "8/3, Asaf Ali Road, New Delhi - 110002, Delhi",
                gst: "07AAACA1549E1ZF"
            }
        };

        // Items data
        const items = [
            { name: "Laptop - Dell Inspiron 15", rate: 45000, unit: "Piece" },
            { name: "Office Chair - Ergonomic", rate: 8500, unit: "Piece" },
            { name: "Printer - HP LaserJet Pro", rate: 12000, unit: "Piece" },
            { name: "Mobile Phone - Samsung Galaxy", rate: 25000, unit: "Piece" },
            { name: "Projector - Epson EB-X41", rate: 35000, unit: "Piece" }
        ];

        let itemCounter = 0;

        function addItem() {
            const container = document.getElementById('itemsContainer');
            const itemDiv = document.createElement('div');
            itemDiv.className = 'item-row';
            itemDiv.innerHTML = `
                <select class="item-select" onchange="updateItemDetails(this)">
                    <option value="">Select Item</option>
                    ${items.map((item, index) => `<option value="${index}">${item.name}</option>`).join('')}
                </select>
                <input type="number" class="item-quantity" placeholder="Quantity" min="1" value="1">
                <input type="number" class="item-rate" placeholder="Rate" min="0" step="0.01" readonly>
                <input type="text" class="item-unit" placeholder="Unit" readonly>
                <button class="btn btn-danger" onclick="removeItem(this)">Remove</button>
            `;
            container.appendChild(itemDiv);
            itemCounter++;
        }

        function removeItem(button) {
            button.parentElement.remove();
        }

        function updateItemDetails(select) {
            const itemIndex = select.value;
            if (itemIndex !== '') {
                const item = items[itemIndex];
                const row = select.parentElement;
                row.querySelector('.item-rate').value = item.rate;
                row.querySelector('.item-unit').value = item.unit;
            }
        }

        function generateDocuments() {
            const customer = document.getElementById('customerSelect').value;
            const poNumber = document.getElementById('poNumber').value;
            const vendorName = document.getElementById('vendorName').value;
            const vendorAddress = document.getElementById('vendorAddress').value;
            const vendorGst = document.getElementById('vendorGst').value;

            if (!customer || !poNumber || !vendorName || !vendorAddress || !vendorGst) {
                alert('Please fill all required fields');
                return;
            }

            const itemRows = document.querySelectorAll('.item-row');
            const selectedItems = [];

            itemRows.forEach(row => {
                const itemSelect = row.querySelector('.item-select');
                const quantity = row.querySelector('.item-quantity').value;
                const rate = row.querySelector('.item-rate').value;
                const unit = row.querySelector('.item-unit').value;

                if (itemSelect.value && quantity && rate) {
                    const item = items[itemSelect.value];
                    selectedItems.push({
                        name: item.name,
                        quantity: parseInt(quantity),
                        rate: parseFloat(rate),
                        unit: unit,
                        amount: parseInt(quantity) * parseFloat(rate)
                    });
                }
            });

            if (selectedItems.length === 0) {
                alert('Please select at least one item');
                return;
            }

            const customerData = customers[customer];
            const currentDate = new Date().toLocaleDateString('en-IN');
            const subtotal = selectedItems.reduce((sum, item) => sum + item.amount, 0);
            const tax = subtotal * 0.18;
            const total = subtotal + tax;

            generatePO(customerData, poNumber, vendorName, vendorAddress, vendorGst, selectedItems, subtotal, tax, total, currentDate);
            generateInvoice(customerData, poNumber, vendorName, vendorAddress, vendorGst, selectedItems, subtotal, tax, total, currentDate);
            generateGRN(customerData, poNumber, vendorName, vendorAddress, vendorGst, selectedItems, subtotal, tax, total, currentDate);

            document.getElementById('documentsSection').classList.remove('hidden');
            document.getElementById('documentsSection').scrollIntoView({ behavior: 'smooth' });
        }

        function generatePO(customer, poNumber, vendorName, vendorAddress, vendorGst, items, subtotal, tax, total, date) {
            const content = `
                <div class="doc-row"><span class="doc-label">PO Number:</span><span>${poNumber}</span></div>
                <div class="doc-row"><span class="doc-label">Date:</span><span>${date}</span></div>
                <div class="doc-row"><span class="doc-label">Customer:</span><span>${customer.name}</span></div>
                <div class="doc-row"><span class="doc-label">Customer Address:</span><span>${customer.address}</span></div>
                <div class="doc-row"><span class="doc-label">Customer GST:</span><span>${customer.gst}</span></div>
                <div class="doc-row"><span class="doc-label">Vendor:</span><span>${vendorName}</span></div>
                <div class="doc-row"><span class="doc-label">Vendor Address:</span><span>${vendorAddress}</span></div>
                <div class="doc-row"><span class="doc-label">Vendor GST:</span><span>${vendorGst}</span></div>
                
                <div style="margin: 20px 0;">
                    <div class="table-header">
                        <div>Item</div>
                        <div>Quantity</div>
                        <div>Rate</div>
                        <div>Amount</div>
                    </div>
                    ${items.map(item => `
                        <div class="table-row">
                            <div>${item.name}</div>
                            <div>${item.quantity} ${item.unit}</div>
                            <div>INR ${item.rate.toFixed(2)}</div>
                            <div>INR ${item.amount.toFixed(2)}</div>
                        </div>
                    `).join('')}
                </div>

                <div class="doc-row"><span class="doc-label">Subtotal:</span><span>INR ${subtotal.toFixed(2)}</span></div>
                <div class="doc-row"><span class="doc-label">Tax (18%):</span><span>INR ${tax.toFixed(2)}</span></div>
                <div class="doc-row"><span class="doc-label">Total:</span><span>INR ${total.toFixed(2)}</span></div>
            `;
            document.getElementById('poContent').innerHTML = content;
        }

        function generateInvoice(customer, poNumber, vendorName, vendorAddress, vendorGst, items, subtotal, tax, total, date) {
            const invoiceNumber = 'INV-' + Date.now();
            const content = `
                <div class="doc-row"><span class="doc-label">Invoice Number:</span><span>${invoiceNumber}</span></div>
                <div class="doc-row"><span class="doc-label">PO Reference:</span><span>${poNumber}</span></div>
                <div class="doc-row"><span class="doc-label">Date:</span><span>${date}</span></div>
                <div class="doc-row"><span class="doc-label">Bill To:</span><span>${customer.name}</span></div>
                <div class="doc-row"><span class="doc-label">Customer Address:</span><span>${customer.address}</span></div>
                <div class="doc-row"><span class="doc-label">Customer GST:</span><span>${customer.gst}</span></div>
                <div class="doc-row"><span class="doc-label">Bill From:</span><span>${vendorName}</span></div>
                <div class="doc-row"><span class="doc-label">Vendor Address:</span><span>${vendorAddress}</span></div>
                <div class="doc-row"><span class="doc-label">Vendor GST:</span><span>${vendorGst}</span></div>
                
                <div style="margin: 20px 0;">
                    <div class="table-header">
                        <div>Item</div>
                        <div>Quantity</div>
                        <div>Rate</div>
                        <div>Amount</div>
                    </div>
                    ${items.map(item => `
                        <div class="table-row">
                            <div>${item.name}</div>
                            <div>${item.quantity} ${item.unit}</div>
                            <div>INR ${item.rate.toFixed(2)}</div>
                            <div>INR ${item.amount.toFixed(2)}</div>
                        </div>
                    `).join('')}
                </div>

                <div class="doc-row"><span class="doc-label">Subtotal:</span><span>INR ${subtotal.toFixed(2)}</span></div>
                <div class="doc-row"><span class="doc-label">Tax (18%):</span><span>INR ${tax.toFixed(2)}</span></div>
                <div class="doc-row"><span class="doc-label">Total:</span><span>INR ${total.toFixed(2)}</span></div>
            `;
            document.getElementById('invoiceContent').innerHTML = content;
        }

        function generateGRN(customer, poNumber, vendorName, vendorAddress, vendorGst, items, subtotal, tax, total, date) {
            const grnNumber = 'GRN-' + Date.now();
            const content = `
                <div class="doc-row"><span class="doc-label">GRN Number:</span><span>${grnNumber}</span></div>
                <div class="doc-row"><span class="doc-label">PO Reference:</span><span>${poNumber}</span></div>
                <div class="doc-row"><span class="doc-label">Receipt Date:</span><span>${date}</span></div>
                <div class="doc-row"><span class="doc-label">Received By:</span><span>${customer.name}</span></div>
                <div class="doc-row"><span class="doc-label">Customer Address:</span><span>${customer.address}</span></div>
                <div class="doc-row"><span class="doc-label">Received From:</span><span>${vendorName}</span></div>
                <div class="doc-row"><span class="doc-label">Vendor Address:</span><span>${vendorAddress}</span></div>
                <div class="doc-row"><span class="doc-label">Vendor GST:</span><span>${vendorGst}</span></div>
                
                <div style="margin: 20px 0;">
                    <div class="table-header">
                        <div>Item</div>
                        <div>Ordered Qty</div>
                        <div>Received Qty</div>
                        <div>Status</div>
                    </div>
                    ${items.map(item => {
                        const receivedQty = Math.max(1, item.quantity - Math.floor(Math.random() * 2));
                        const status = receivedQty === item.quantity ? 'Complete' : 'Partial';
                        return `
                            <div class="table-row">
                                <div>${item.name}</div>
                                <div>${item.quantity} ${item.unit}</div>
                                <div>${receivedQty} ${item.unit}</div>
                                <div>${status}</div>
                            </div>
                        `;
                    }).join('')}
                </div>

                <div class="doc-row"><span class="doc-label">Total Value:</span><span>INR ${total.toFixed(2)}</span></div>
                <div class="doc-row"><span class="doc-label">Status:</span><span>Goods Received</span></div>
            `;
            document.getElementById('grnContent').innerHTML = content;
        }

        // PDF Download functionality
        function downloadPDF(docType) {
            const { jsPDF } = window.jspdf;
            
            let data, filename, title;
            
            // Get document data based on type
            switch(docType) {
                case 'po':
                    data = getPOData();
                    filename = `Purchase_Order_${document.getElementById('poNumber').value || 'PO'}.pdf`;
                    title = 'PURCHASE ORDER';
                    break;
                case 'invoice':
                    data = getInvoiceData();
                    filename = `Invoice_${document.getElementById('poNumber').value || 'INV'}.pdf`;
                    title = 'INVOICE';
                    break;
                case 'grn':
                    data = getGRNData();
                    filename = `GRN_${document.getElementById('poNumber').value || 'GRN'}.pdf`;
                    title = 'GOODS RECEIPT NOTE';
                    break;
            }

            if (!data) {
                alert('Please generate documents first');
                return;
            }

            const pdf = new jsPDF('p', 'mm', 'a4');
            const pageWidth = pdf.internal.pageSize.getWidth();
            const pageHeight = pdf.internal.pageSize.getHeight();
            let yPosition = 20;

            // Header
            pdf.setFontSize(18);
            pdf.setFont(undefined, 'bold');
            const titleWidth = pdf.getTextWidth(title);
            pdf.text(title, (pageWidth - titleWidth) / 2, yPosition);
            yPosition += 15;

            // Document details
            pdf.setFontSize(10);
            pdf.setFont(undefined, 'normal');
            
            data.details.forEach(detail => {
                if (yPosition > pageHeight - 30) {
                    pdf.addPage();
                    yPosition = 20;
                }
                pdf.setFont(undefined, 'bold');
                pdf.text(detail.label + ':', 15, yPosition);
                pdf.setFont(undefined, 'normal');
                const valueLines = pdf.splitTextToSize(detail.value, 120);
                pdf.text(valueLines, 60, yPosition);
                yPosition += valueLines.length * 4 + 2;
            });

            yPosition += 10;

            // Items table
            if (data.items && data.items.length > 0) {
                // Table header
                pdf.setFillColor(55, 65, 81);
                pdf.rect(15, yPosition, pageWidth - 30, 8, 'F');
                pdf.setTextColor(255, 255, 255);
                pdf.setFont(undefined, 'bold');
                pdf.text('Item', 18, yPosition + 5);
                pdf.text('Qty', 100, yPosition + 5);
                pdf.text('Rate', 130, yPosition + 5);
                pdf.text('Amount', 160, yPosition + 5);
                yPosition += 10;

                // Table rows
                pdf.setTextColor(0, 0, 0);
                pdf.setFont(undefined, 'normal');
                
                data.items.forEach((item, index) => {
                    if (yPosition > pageHeight - 30) {
                        pdf.addPage();
                        yPosition = 20;
                    }
                    
                    if (index % 2 === 0) {
                        pdf.setFillColor(249, 250, 251);
                        pdf.rect(15, yPosition - 2, pageWidth - 30, 8, 'F');
                    }
                    
                    const itemName = pdf.splitTextToSize(item.name, 80);
                    pdf.text(itemName, 18, yPosition + 3);
                    pdf.text(item.quantity, 100, yPosition + 3);
                    pdf.text(item.rate, 130, yPosition + 3);
                    pdf.text(item.amount, 160, yPosition + 3);
                    yPosition += Math.max(8, itemName.length * 4);
                });
            }

            yPosition += 10;

            // Totals
            if (data.totals) {
                data.totals.forEach(total => {
                    if (yPosition > pageHeight - 20) {
                        pdf.addPage();
                        yPosition = 20;
                    }
                    pdf.setFont(undefined, total.isFinal ? 'bold' : 'normal');
                    if (total.isFinal) {
                        pdf.setFillColor(248, 250, 252);
                        pdf.rect(120, yPosition - 2, 75, 8, 'F');
                    }
                    pdf.text(total.label + ':', 125, yPosition + 3);
                    pdf.text(total.value, 170, yPosition + 3);
                    yPosition += 8;
                });
            }

            pdf.save(filename);
        }

        function getPOData() {
            const customer = customers[document.getElementById('customerSelect').value];
            if (!customer) return null;

            const poNumber = document.getElementById('poNumber').value;
            const vendorName = document.getElementById('vendorName').value;
            const vendorAddress = document.getElementById('vendorAddress').value;
            const vendorGst = document.getElementById('vendorGst').value;
            const currentDate = new Date().toLocaleDateString('en-IN');

            const items = getSelectedItems();
            const subtotal = items.reduce((sum, item) => sum + item.amount, 0);
            const tax = subtotal * 0.18;
            const total = subtotal + tax;

            return {
                details: [
                    { label: 'PO Number', value: poNumber },
                    { label: 'Date', value: currentDate },
                    { label: 'Customer', value: customer.name },
                    { label: 'Customer Address', value: customer.address },
                    { label: 'Customer GST', value: customer.gst },
                    { label: 'Vendor', value: vendorName },
                    { label: 'Vendor Address', value: vendorAddress },
                    { label: 'Vendor GST', value: vendorGst }
                ],
                items: items.map(item => ({
                    name: item.name,
                    quantity: `${item.quantity} ${item.unit}`,
                    rate: `INR ${item.rate.toFixed(2)}`,
                    amount: `INR ${item.amount.toFixed(2)}`
                })),
                totals: [
                    { label: 'Subtotal', value: `INR ${subtotal.toFixed(2)}`, isFinal: false },
                    { label: 'Tax (18%)', value: `INR ${tax.toFixed(2)}`, isFinal: false },
                    { label: 'Total', value: `INR ${total.toFixed(2)}`, isFinal: true }
                ]
            };
        }

        function getInvoiceData() {
            const customer = customers[document.getElementById('customerSelect').value];
            if (!customer) return null;

            const poNumber = document.getElementById('poNumber').value;
            const vendorName = document.getElementById('vendorName').value;
            const vendorAddress = document.getElementById('vendorAddress').value;
            const vendorGst = document.getElementById('vendorGst').value;
            const currentDate = new Date().toLocaleDateString('en-IN');
            const invoiceNumber = 'INV-' + Date.now();

            const items = getSelectedItems();
            const subtotal = items.reduce((sum, item) => sum + item.amount, 0);
            const tax = subtotal * 0.18;
            const total = subtotal + tax;

            return {
                details: [
                    { label: 'Invoice Number', value: invoiceNumber },
                    { label: 'PO Reference', value: poNumber },
                    { label: 'Date', value: currentDate },
                    { label: 'Bill To', value: customer.name },
                    { label: 'Customer Address', value: customer.address },
                    { label: 'Customer GST', value: customer.gst },
                    { label: 'Bill From', value: vendorName },
                    { label: 'Vendor Address', value: vendorAddress },
                    { label: 'Vendor GST', value: vendorGst }
                ],
                items: items.map(item => ({
                    name: item.name,
                    quantity: `${item.quantity} ${item.unit}`,
                    rate: `INR ${item.rate.toFixed(2)}`,
                    amount: `INR ${item.amount.toFixed(2)}`
                })),
                totals: [
                    { label: 'Subtotal', value: `INR ${subtotal.toFixed(2)}`, isFinal: false },
                    { label: 'Tax (18%)', value: `INR ${tax.toFixed(2)}`, isFinal: false },
                    { label: 'Total', value: `INR ${total.toFixed(2)}`, isFinal: true }
                ]
            };
        }

        function getGRNData() {
            const customer = customers[document.getElementById('customerSelect').value];
            if (!customer) return null;

            const poNumber = document.getElementById('poNumber').value;
            const vendorName = document.getElementById('vendorName').value;
            const vendorAddress = document.getElementById('vendorAddress').value;
            const vendorGst = document.getElementById('vendorGst').value;
            const currentDate = new Date().toLocaleDateString('en-IN');
            const grnNumber = 'GRN-' + Date.now();

            const items = getSelectedItems();
            const total = items.reduce((sum, item) => sum + item.amount, 0) * 1.18;

            return {
                details: [
                    { label: 'GRN Number', value: grnNumber },
                    { label: 'PO Reference', value: poNumber },
                    { label: 'Receipt Date', value: currentDate },
                    { label: 'Received By', value: customer.name },
                    { label: 'Customer Address', value: customer.address },
                    { label: 'Received From', value: vendorName },
                    { label: 'Vendor Address', value: vendorAddress },
                    { label: 'Vendor GST', value: vendorGst }
                ],
                items: items.map(item => {
                    const receivedQty = Math.max(1, item.quantity - Math.floor(Math.random() * 2));
                    const status = receivedQty === item.quantity ? 'Complete' : 'Partial';
                    return {
                        name: item.name,
                        quantity: `${item.quantity} ${item.unit}`,
                        rate: `${receivedQty} ${item.unit}`,
                        amount: status
                    };
                }),
                totals: [
                    { label: 'Total Value', value: `INR ${total.toFixed(2)}`, isFinal: false },
                    { label: 'Status', value: 'Goods Received', isFinal: true }
                ]
            };
        }

        function getSelectedItems() {
            const itemRows = document.querySelectorAll('.item-row');
            const selectedItems = [];

            itemRows.forEach(row => {
                const itemSelect = row.querySelector('.item-select');
                const quantity = row.querySelector('.item-quantity').value;
                const rate = row.querySelector('.item-rate').value;
                const unit = row.querySelector('.item-unit').value;

                if (itemSelect.value && quantity && rate) {
                    const item = items[itemSelect.value];
                    selectedItems.push({
                        name: item.name,
                        quantity: parseInt(quantity),
                        rate: parseFloat(rate),
                        unit: unit,
                        amount: parseInt(quantity) * parseFloat(rate)
                    });
                }
            });

            return selectedItems;
        }

        // Initialize with one item row
        addItem();
    </script>
</body>
</html>
